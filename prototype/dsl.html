<!DOCTYPE html>
<html>
<meta charset="utf-8">
<head>
    <script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.7.0/underscore-min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.js"></script>

    <!-- src -->
    <script src="../src/class.js"></script>
    <script src="../src/tau.data.js"></script>
    <script src="../src/tau.data.types.js"></script>
    <script src="../src/tau.svg.js"></script>
    <script src="../src/tau.charts.js"></script>
    <script src="../src/charts/line.js"></script>
    <script src="../src/charts/scatterplot.js"></script>
    <script src="../src/charts/bar.js"></script>
    <script src="../src/tau.plugins.js"></script>
    <script src="../src/dsl/dsl-reader.js"></script>

    <script src="../src/dsl/matrix.js"></script>
    <script src="../src/dsl/unit-visitor-factory.js"></script>
    <script src="../src/dsl/node-visitor-factory.js"></script>

    <!-- plugins -->
    <script src="../plugins/tooltip.js"></script>
    <script src="../plugins/legend.js"></script>
    <script src="../plugins/highlighter.js"></script>
    <script src="../plugins/projection.js"></script>
    <script src="../plugins/datatable.js"></script>
    <script src="../plugins/header.js"></script>
    <script src="../plugins/trend.js"></script>
    <script src="../plugins/jittering.js"></script>

    <!-- test data -->
    <script src="data.js"></script>

    <script src="countries.js"></script>
    <script src="tpStories.js"></script>
    <script src="../src/dsl/tau.newCharts.js"></script>
    <!-- css -->
    <link href="../css/default.css" rel="stylesheet"/>
    <link href="../css/oldschool.css" rel="stylesheet"/>
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,400,600&subset=latin,cyrillic-ext' rel='stylesheet' type='text/css">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,700&subset=latin,cyrillic-ext' rel='stylesheet'
          type='text/css'>
    <style>
        .axes.nest .axis.nest text {
            font-size: 10px;
        }
    </style>
</head>
<body>

<div id="chart-container" style="display:inline-block;margin:0px;float:left"></div>

<div id="simple-container" style="display:inline-block;margin:0px;float:left"></div>

<div id="complex-container" style="display:inline-block;margin:0px;float:left"></div>

<script>

    var def = {
        container:'#chart-container',
        W: 800,
        H: 800,
        unit: {
            type: 'COORDS/RECT',
            func: 'CROSS',
            showGrid: false,
            axes: [
                {scaleDim: 'project', scaleType: 'ordinal', label: '<h4>Projects</h4>'},
                {scaleDim: 'team', scaleType: 'ordinal', label: '<h4>Teams</h4>'}
            ],
            unit: [
                {
                    type: 'COORDS/RECT',
                    showGrid: true,
                    axes: [
                        {scaleDim: 'cycleTime', scaleType: 'linear', label: '<h4>cycle time</h4>', bubble :true},
                        {scaleDim: 'effort', scaleType: 'linear', label: '<h4>effort</h4>', bubble:true}
                    ],
                    unit: [
                        {
                            type: 'ELEMENT/POINT',
                            x: 'cycleTime',
                            y: 'effort',
                            color: 'effort',
                            size: 'cycleTime',
                            shape: null
                        }
                    ]
                }
            ]
        }
    };

    var scatter = {
        container: '#simple-container',
        W: 800,
        H: 800,
        unit: {
            type: 'COORDS.RECT',
            showGridLines: 'xy',
            axes: [
                {
                    scaleDim: 'cycleTime',
                    scaleType: 'linear',
                    label: '<h4>cycle time</h4>',
                    lwidth: 36,
                    rwidth: 12,
                    padding: 8,
                    bubble: true
                },
                {
                    scaleDim: 'effort',
                    scaleType: 'linear',
                    label: '<h4>effort</h4>',
                    lwidth: 36,
                    rwidth: 12,
                    padding: 8,
                    bubble: true
                }
            ],
            unit: [
                {
                    type: 'ELEMENT/POINT',
                    x: 'cycleTime',
                    y: 'effort',
                    color: 'effort',
                    size: 'cycleTime',
                    shape: null
                }
            ]
        }
    };

    var complex_scatter = {
        container: '#complex-container',
        W: 800,
        H: 800,
        unit: {
            type: 'COORDS.RECT',
            func: 'CROSS',
            axes: [
                {scaleDim: 'project', scaleType: 'ordinal', label: '<h4>Projects</h4>'},
                {scaleDim: 'team', scaleType: 'ordinal', label: '<h4>Teams</h4>'}
            ],
            unit: [
                {
                    type: 'COORDS.RECT',
                    showGridLines: 'xy',
                    axes: [
                        {
                            scaleDim: 'cycleTime',
                            scaleType: 'linear',
                            label: '<h4>cycle time</h4>',
                            hide: true,
                            lwidth: 0,
                            rwidth: 0,
                            padding: 0,
                            bubble: true
                        },
                        {
                            scaleDim: 'effort',
                            scaleType: 'linear',
                            label: '<h4>effort</h4>',
                            hide: true,
                            lwidth: 0,
                            rwidth: 0,
                            padding: 0,
                            bubble: true
                        }
                    ],
                    unit: [
                        {
                            type: 'ELEMENT/POINT',
                            x: 'cycleTime',
                            y: 'effort',
                            color: 'effort',
                            size: 'cycleTime',
                            shape: null
                        }
                    ]
                }
            ]
        }
    };

    var rawData = _.map(
            getUserStories(),
            function (r) {
                r.cycleTime = r.name.length;
                return r;
            });

    var chart = new Chart({
        data: rawData,
        spec: def,
        plugins: [tau.plugins.tooltip('team', 'project', 'cycleTime', 'effort'), tau.plugins.highlighter()]
    });

    var scatterChart = new Chart({
        data: rawData,
        spec: scatter,
        plugins: [tau.plugins.tooltip('team', 'project', 'cycleTime', 'effort'), tau.plugins.highlighter()]
    });

    var complexChart = new Chart({
        data: rawData,
        spec: complex_scatter,
        plugins: [tau.plugins.tooltip('team', 'project', 'cycleTime', 'effort'), tau.plugins.highlighter()]
    });

</script>
</body>
</html>